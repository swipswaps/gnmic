<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="gnmi client and collector command line interface"><meta name=author content="Karim Radhouani"><link rel="shortcut icon" href=../../images/pulse.svg><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.1.0"><title>Prompt mode and auto-suggestions - gNMIc</title><link rel=stylesheet href=../../assets/stylesheets/main.bc7e593a.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab28b872.min.css><meta name=theme-color content=#2094f3><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Manrope:300,400,400i,700%7CFira+Mono&display=fallback"><style>body,input{font-family:"Manrope",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-177206500-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=blue data-md-color-accent=indigo> <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#using-the-prompt-interface class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../.. title=gNMIc class="md-header-nav__button md-logo" aria-label=gNMIc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path fill-rule=evenodd d="M9.002 2.5a.75.75 0 01.691.464l6.302 15.305 2.56-6.301a.75.75 0 01.695-.468h4a.75.75 0 010 1.5h-3.495l-3.06 7.532a.75.75 0 01-1.389.004L8.997 5.21l-3.054 7.329A.75.75 0 015.25 13H.75a.75.75 0 010-1.5h4l3.558-8.538a.75.75 0 01.694-.462z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> gNMIc </span> <span class="md-header-nav__topic md-ellipsis"> Prompt mode and auto-suggestions </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/karimra/gnmic title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> karimra/gnmic </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=gNMIc class="md-nav__button md-logo" aria-label=gNMIc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path fill-rule=evenodd d="M9.002 2.5a.75.75 0 01.691.464l6.302 15.305 2.56-6.301a.75.75 0 01.695-.468h4a.75.75 0 010 1.5h-3.495l-3.06 7.532a.75.75 0 01-1.389.004L8.997 5.21l-3.054 7.329A.75.75 0 015.25 13H.75a.75.75 0 010-1.5h4l3.558-8.538a.75.75 0 01.694-.462z"/></svg> </a> gNMIc </label> <div class=md-nav__source> <a href=https://github.com/karimra/gnmic title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> karimra/gnmic </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Getting started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting started" data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../install/ class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=../../basic_usage/ class=md-nav__link> Basic usage </a> </li> <li class=md-nav__item> <a href=../../global_flags/ class=md-nav__link> Global flags </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Advanced usage <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced usage" data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"></span> Advanced usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../file_cfg/ class=md-nav__link> File based configuration </a> </li> <li class=md-nav__item> <a href=../multi_target/ class=md-nav__link> Multiple targets </a> </li> <li class=md-nav__item> <a href=../subscriptions/ class=md-nav__link> Multiple subscriptions </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Prompt mode and auto-suggestions <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Prompt mode and auto-suggestions </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#using-the-prompt-interface class=md-nav__link> Using the prompt interface </a> </li> <li class=md-nav__item> <a href=#commands-and-flags-suggestions class=md-nav__link> Commands and flags suggestions </a> <nav class=md-nav aria-label="Commands and flags suggestions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mixed-mode class=md-nav__link> Mixed mode </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#yang-completions class=md-nav__link> YANG-completions </a> <nav class=md-nav aria-label=YANG-completions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#yang-processing class=md-nav__link> YANG processing </a> </li> <li class=md-nav__item> <a href=#understanding-path-suggestions class=md-nav__link> Understanding path suggestions </a> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nokia-sr-os class=md-nav__link> Nokia SR OS </a> </li> <li class=md-nav__item> <a href=#openconfig class=md-nav__link> Openconfig </a> </li> <li class=md-nav__item> <a href=#cisco class=md-nav__link> Cisco </a> <nav class=md-nav aria-label=Cisco> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ios-xr class=md-nav__link> IOS-XR </a> </li> <li class=md-nav__item> <a href=#nx-os class=md-nav__link> NX-OS </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#juniper class=md-nav__link> Juniper </a> </li> <li class=md-nav__item> <a href=#arista class=md-nav__link> Arista </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enumeration-suggestions class=md-nav__link> Enumeration suggestions </a> </li> <li class=md-nav__item> <a href=#file-path-completions class=md-nav__link> File-path completions </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-5 type=checkbox id=nav-3-5> <label class=md-nav__link for=nav-3-5> Multiple outputs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Multiple outputs" data-md-level=2> <label class=md-nav__title for=nav-3-5> <span class="md-nav__icon md-icon"></span> Multiple outputs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../multi_outputs/output_intro/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../multi_outputs/file_output/ class=md-nav__link> File </a> </li> <li class=md-nav__item> <a href=../multi_outputs/nats_output/ class=md-nav__link> NATS </a> </li> <li class=md-nav__item> <a href=../multi_outputs/stan_output/ class=md-nav__link> STAN </a> </li> <li class=md-nav__item> <a href=../multi_outputs/kafka_output/ class=md-nav__link> Kafka </a> </li> <li class=md-nav__item> <a href=../multi_outputs/prometheus_output/ class=md-nav__link> Prometheus </a> </li> <li class=md-nav__item> <a href=../multi_outputs/tcp_output/ class=md-nav__link> TCP </a> </li> <li class=md-nav__item> <a href=../multi_outputs/udp_output/ class=md-nav__link> UDP </a> </li> <li class=md-nav__item> <a href=../multi_outputs/influxdb_output/ class=md-nav__link> InfluxDB </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Command reference <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Command reference" data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"></span> Command reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cmd/capabilities/ class=md-nav__link> Capabilities </a> </li> <li class=md-nav__item> <a href=../../cmd/get/ class=md-nav__link> Get </a> </li> <li class=md-nav__item> <a href=../../cmd/set/ class=md-nav__link> Set </a> </li> <li class=md-nav__item> <a href=../../cmd/subscribe/ class=md-nav__link> Subscribe </a> </li> <li class=md-nav__item> <a href=../../cmd/listen/ class=md-nav__link> Listen </a> </li> <li class=md-nav__item> <a href=../../cmd/path/ class=md-nav__link> Path </a> </li> <li class=md-nav__item> <a href=../../cmd/prompt/ class=md-nav__link> Prompt </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#using-the-prompt-interface class=md-nav__link> Using the prompt interface </a> </li> <li class=md-nav__item> <a href=#commands-and-flags-suggestions class=md-nav__link> Commands and flags suggestions </a> <nav class=md-nav aria-label="Commands and flags suggestions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mixed-mode class=md-nav__link> Mixed mode </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#yang-completions class=md-nav__link> YANG-completions </a> <nav class=md-nav aria-label=YANG-completions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#yang-processing class=md-nav__link> YANG processing </a> </li> <li class=md-nav__item> <a href=#understanding-path-suggestions class=md-nav__link> Understanding path suggestions </a> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nokia-sr-os class=md-nav__link> Nokia SR OS </a> </li> <li class=md-nav__item> <a href=#openconfig class=md-nav__link> Openconfig </a> </li> <li class=md-nav__item> <a href=#cisco class=md-nav__link> Cisco </a> <nav class=md-nav aria-label=Cisco> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ios-xr class=md-nav__link> IOS-XR </a> </li> <li class=md-nav__item> <a href=#nx-os class=md-nav__link> NX-OS </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#juniper class=md-nav__link> Juniper </a> </li> <li class=md-nav__item> <a href=#arista class=md-nav__link> Arista </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enumeration-suggestions class=md-nav__link> Enumeration suggestions </a> </li> <li class=md-nav__item> <a href=#file-path-completions class=md-nav__link> File-path completions </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Prompt mode and auto-suggestions</h1> <p>Starting with <code>gnmic v0.4.0</code> release the users can enjoy the interactive prompt mode which can be enabled with the <a href=../../cmd/prompt/ ><code>prompt</code></a> command.</p> <script id=asciicast-QaJRqrLSOGvgcAavybsMRzD7c data-autoplay=true data-loop=true src=https://asciinema.org/a/QaJRqrLSOGvgcAavybsMRzD7c.js async></script> <p>The prompt mode delivers two major features:</p> <ul> <li>simplifies <code>gnmic</code> commands and flags navigation, as every option is suggested and auto-completed</li> <li>provides interactive YANG path auto-suggestions for <code>get</code>, <code>set</code>, <code>subscribe</code> commands effectively making the terminal your YANG browser</li> </ul> <h2 id=using-the-prompt-interface>Using the prompt interface<a class=headerlink href=#using-the-prompt-interface title="Permanent link">#</a></h2> <p>Depending on the cursor position in the prompt line, a so-called <em>suggestion box</em> pops up with contextual auto-completions. The user can enter the suggestion box by pressing the <kbd>TAB</kbd> key. The <kbd>↑</kbd> and <kbd>↓</kbd> keys can be used to navigate the suggestion list.</p> <p>Select the suggested menu item with <kbd>SPACE</kbd> key or directly commit your command with <kbd>ENTER</kbd>, its that easy!</p> <p>The following most-common key bindings will work in the prompt mode:</p> <table> <thead> <tr> <th>Key combination</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><kbd>Option/Control</kbd> + <kbd>→/←</kbd></td> <td>move cursor a word right/left</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>W</kbd></td> <td>delete a word to the left</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>Z</kbd></td> <td>delete a path element in the xpath string (<a href=https://gitlab.com/rdodin/pics/-/wikis/uploads/cc97ef563e2b973da512951fedd1ddb8/CleanShot_2020-10-21_at_11.37.57.mp4>example</a>)</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>A</kbd></td> <td>move cursor to the beginning of a line</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>E</kbd></td> <td>move cursor to the end of a line</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>C</kbd></td> <td>discard the current line</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>D</kbd></td> <td>exit prompt</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>K</kbd></td> <td>delete the line after the cursor to the clipboard</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>U</kbd></td> <td>delete the line before the cursor to the clipboard</td> </tr> <tr> <td><kbd>Control</kbd> + <kbd>L</kbd></td> <td>clear screen</td> </tr> </tbody> </table> <h2 id=commands-and-flags-suggestions>Commands and flags suggestions<a class=headerlink href=#commands-and-flags-suggestions title="Permanent link">#</a></h2> <p>To make <code>gnmic</code> configurable and flexible we introduced a considerable amount of flags and sub-commands.<br> To help the users navigate the sheer selection of <code>gnmic</code> configuration options, the prompt mode will auto-suggest the global flags, sub-commands and local flags of those sub-commands.</p> <p>When the prompt mode is launched, the suggestions will be shown for the top-level commands and all the global flags. Once the sub-command is typed into the terminal, the auto-suggestions will be provided for the commands nested under this command and its local flags.</p> <p>In the following demo we show how the command and flag suggestions work. As the prompt starts, the suggestion box immediately hints what commands and global flags are available for input as well as their description.</p> <p>The user starts with adding the global flags <code>--address, --insecure, --username</code> and then selects the <code>capabilities</code> command and commits it. This results in gNMI Capability RPC execution against a specified target.</p> <script id=asciicast-zsACIBIUiiyoeqgYQ82EjUCIM src=https://asciinema.org/a/zsACIBIUiiyoeqgYQ82EjUCIM.js async></script> <h3 id=mixed-mode>Mixed mode<a class=headerlink href=#mixed-mode title="Permanent link">#</a></h3> <p>Its perfectly fine to specify some global flags outside of the prompt command and add more within the prompt mode. For example, the following is a valid invocation:</p> <div class=highlight><pre><span></span><code>gnmic --insecure --username admin --password admin --address 10.1.0.11 prompt
</code></pre></div> <p>Here the prompt will start with with the <code>insecure, username, password, address</code> flags set.</p> <h2 id=yang-completions>YANG-completions<a class=headerlink href=#yang-completions title="Permanent link">#</a></h2> <p>One of the most challenging problems in the network automation field is to process the YANG models and traverse YANG trees to construct the requests used against the network elements.<br> Be it gNMI, NETCONF or RESTCONF a users still needs to have a path pointing to specific YANG-defined node which is targeted by a request.</p> <p>In gNMI paths can be represented in a <a href=https://github.com/openconfig/reference/blob/master/rpc/gnmi/gnmi-path-conventions.md#constructing-paths>human readable XPATH-like form</a> - <code>/a/b/c[key=val]/d</code> - and these paths are based on the underlying YANG models.<br> The problem at hand was how to get these paths interactively, or even better - walk the YANG tree from within the CLI and dynamically build the path used in a gNMI RPC?</p> <p>With <strong>YANG-completions</strong> feature embedded in <code>gnmic</code> what used to be a dream is now a reality 🎉</p> <p align=center><script id=asciicast-G1O3pN7xRMLe0tqHjBvDJ7mYA src=https://asciinema.org/a/G1O3pN7xRMLe0tqHjBvDJ7mYA.js async></script></p> <p>Let us explain what just happened there.</p> <p>In the demonstration above, we called the <code>gnmic</code> with the well-known flags defining the gNMI target (<code>address</code>, <code>username</code>, <code>password</code>). But this time we also added a few YANG specific flags (<a href=../../cmd/prompt/#file><code>--file</code></a> and <a href=../../cmd/prompt/#dir><code>--dir</code></a>) that load the full set of Nokia SR OS YANG models and the 3<sup>rd</sup> party models SR OS rely on.</p> <div class=highlight><pre><span></span><code>gnmic --address 10.1.0.11 --insecure --username admin --password admin \
      --file ~/7x50_YangModels/YANG/nokia-combined \
      --dir ~/7x50_YangModels/YANG \
      prompt
</code></pre></div> <p>In the background <code>gnmic</code> processed these YANG models to build the entire schema tree of the Nokia SR OS state and configuration datastores. With that in-mem stored information, <code>gnmic</code> was able to auto-suggest all the possible YANG paths when the user entered the <code>--path</code> flag which accepts gNMI paths.</p> <p>By using the auto-suggestion hints, a user navigated the <code>/state</code> tree of a router and drilled down to the version-number leaf that, in the end, was retrieved with the gNMI Get RPC.</p> <div class="admonition success"> <p class=admonition-title>YANG-driven path suggestions</p> <p><code>gnmic</code> is now capable of reading and processing YANG modules to enable live path auto-suggestions</p> </div> <h3 id=yang-processing>YANG processing<a class=headerlink href=#yang-processing title="Permanent link">#</a></h3> <p>For the YANG-completion feature to work its absolutely imperative for <code>gnmic</code> to successfully parse and compile the YANG models.</p> <p>The <a href=../../cmd/prompt/ ><code>prompt</code></a> command leverages the <a href=../../cmd/prompt/#file><code>--file</code></a> and <a href=../../cmd/prompt/#dir><code>--dir</code></a> flags to select the YANG models for processing.</p> <p>With the <code>--file</code> flag a user specifies a file path to a YANG file or a directory of them that <code>gnmic</code> will read and process. If it points to a directory it will be visited recursively reading in all <code>*.yang</code> files it finds.</p> <p>The <code>--dir</code> flag also points to a YANG file or a directory and indicates which additional YANG files might be required. For example, if the YANG modules that a user specified with the <code>--file</code> flag import or include modules that were not part of the path specified with <code>--file</code>, they need to be added with the <code>--dir</code> flag.</p> <p>The <a href=#examples>Examples</a> section provide some good practical examples on how these two flags can be used together to process the YANG models from different vendors.</p> <h3 id=understanding-path-suggestions>Understanding path suggestions<a class=headerlink href=#understanding-path-suggestions title="Permanent link">#</a></h3> <p>When <code>gnmic</code> provides a user with the path suggestions it does it in a smart and intuitive way.</p> <p><img alt="path suggestions" src=https://gitlab.com/rdodin/pics/-/wikis/uploads/d3815b474605765989d136753c0f9c87/image.png></p> <p>First, it understands in what part of the tree a user currently is and suggests only the next possible elements.</p> <p>Additionally, the suggested next path elements will be augmented with the information extracted from the YANG model, such as:</p> <ul> <li>element description, as given in the YANG <code>description</code> statement for the element</li> <li>element configuration state (<code>rw</code> / <code>ro</code>), as defined in section <a href=https://tools.ietf.org/html/rfc7950#section-4.2.3>4.2.3 of RFC 7950</a>.</li> <li>node type:<ul> <li>The containers and lists will be denoted with the <code>[+]</code> marker, which means that a user can type <code>/</code> char after them to receive suggestions for the nested elements.</li> <li>the <code>[⋯]</code> character belongs to a leaf-list element.</li> <li>an empty space will indicate the leaf element.</li> </ul> </li> </ul> <h3 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">#</a></h3> <p>The examples in this section will show how to use the <code>--file</code> and <code>--dir</code> flags of the <a href=../../cmd/prompt/ ><code>prompt</code></a> command with the YANG collections from different vendors and standard bodies.</p> <h4 id=nokia-sr-os>Nokia SR OS<a class=headerlink href=#nokia-sr-os title="Permanent link">#</a></h4> <p>YANG repo: <a href=https://github.com/nokia/7x50_YangModels>nokia/7x50_YangModels</a></p> <p>Clone the repository with Nokia YANG models and checkout the release of interest:</p> <div class=highlight><pre><span></span><code>git clone https://github.com/nokia/7x50_YangModels
cd 7x50_YangModels
git checkout sros_20.7.r2
</code></pre></div> <p>Start <code>gnmic</code> in prompt mode and read in the nokia-combined YANG modules:</p> <div class=highlight><pre><span></span><code>gnmic --file YANG/nokia-combined \
      --dir YANG \
      prompt
</code></pre></div> <p>This will enable path auto-suggestions for the entire tree of the Nokia SR OS YANG models.</p> <p>The full command with the gNMI target specified could look like this:</p> <div class=highlight><pre><span></span><code>gnmic --address 10.1.0.11 --insecure --username admin --password admin \
      prompt \
      --file ~/7x50_YangModels/YANG/nokia-combined \
      --dir ~/7x50_YangModels/YANG
</code></pre></div> <h4 id=openconfig>Openconfig<a class=headerlink href=#openconfig title="Permanent link">#</a></h4> <p>YANG repo: <a href=https://github.com/openconfig/public>openconfig/public</a></p> <p>Clone the OpenConfig repository:</p> <div class=highlight><pre><span></span><code>git clone https://github.com/openconfig/public
cd public
</code></pre></div> <p>Start <code>gnmic</code> in prompt mode and read in all the modules:</p> <div class=highlight><pre><span></span><code>gnmic --file release/models \
      --dir third_party \
      --exclude ietf-interfaces \
      prompt
</code></pre></div> <script id=asciicast-pcEq80BAs0N9RvgMLZTYJ9S8I src=https://asciinema.org/a/pcEq80BAs0N9RvgMLZTYJ9S8I.js async></script> <div class="admonition note"> <p class=admonition-title>Note</p> <p>With OpenConfig models we have to use <code>--exclude</code> flag to exclude ietf-interfaces module from being clashed with OpenConfig interfaces module.</p> </div> <h4 id=cisco>Cisco<a class=headerlink href=#cisco title="Permanent link">#</a></h4> <p>YANG repo: <a href=https://github.com/YangModels/yang>YangModels/yang</a></p> <p>Clone the <code>YangModels/yang</code> repo and change into the main directory of the repo:</p> <div class=highlight><pre><span></span><code>git clone https://github.com/YangModels/yang
cd yang/vendor
</code></pre></div> <h5 id=ios-xr>IOS-XR<a class=headerlink href=#ios-xr title="Permanent link">#</a></h5> <p>The IOS-XR native YANG models are disaggregated and spread all over the place. Although its technically possible to load them all in one go, this approach will produce a lot of top-level modules making the navigation quite hard.</p> <p>An easier and cleaner approach would be to find the relevant module(s) and load them separately or in small batches. For example here we load BGP config and operational models together:</p> <div class=highlight><pre><span></span><code>gnmic --file vendor/cisco/xr/721/Cisco-IOS-XR-um-router-bgp-cfg.yang \
      --file vendor/cisco/xr/721/Cisco-IOS-XR-ipv4-bgp-oper.yang \
      --dir standard/ietf \
      prompt
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>We needed to include the <code>ietf/</code> directory by means of the <code>--dir</code> flag, since the Cisco's native modules rely on the IETF modules and these modules are not in the same directory as the BGP modules.</p> </div> <p>The full command that you can against the real Cisco IOS-XR node must have a target defined, the encoding set and origin suggestions enabled. Here is what it can look like:</p> <div class=highlight><pre><span></span><code>gnmic -a 10.10.30.5:57500 --insecure -e json_ietf -u admin -p Cisco123 \
      prompt \
      --file yang/vendor/cisco/xr/662/Cisco-IOS-XR-ipv4-bgp-cfg.yang \
      --file yang/vendor/cisco/xr/662/Cisco-IOS-XR-ipv4-bgp-oper.yang \
      --dir yang/standard/ietf \
      --suggest-with-origin
</code></pre></div> <h5 id=nx-os>NX-OS<a class=headerlink href=#nx-os title="Permanent link">#</a></h5> <p>Cisco NX-OS native modules, on the other hand, are aggregated in a single file, here is how you can generate the suggestions from it:</p> <div class=highlight><pre><span></span><code>gnmic --file vendor/cisco/xr/721/Cisco-IOS-XR-um-router-bgp-cfg.yang \
      --dir standard/ietf \
      prompt
</code></pre></div> <h4 id=juniper>Juniper<a class=headerlink href=#juniper title="Permanent link">#</a></h4> <p>YANG repo: <a href=https://github.com/Juniper/yang>Juniper/yang</a></p> <p>Clone the Juniper YANG repository and change into the release directory:</p> <div class=highlight><pre><span></span><code>git clone https://github.com/Juniper/yang
cd yang/20.3/20.3R1
</code></pre></div> <p>Start <code>gnmic</code> and generate path suggestions for the whole configuration tree of Juniper MX:</p> <div class=highlight><pre><span></span><code>gnmic --file junos/conf --dir common prompt
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <ol> <li>Juniper models are constructed in a way that a top-level container appears to be <code>/configuration</code>, that will not work with your gNMI Subscribe RPC. Instead, you should omit this top level container. So, for example, the suggested path <code>/configuration/interfaces/interface/state</code> should become <code>/interfaces/interface/state</code>.</li> <li>Juniper vMX doesn't support gNMI Get RPC, if you plan to test it, use gNMI Subscribe RPC</li> <li>With gNMI Subscribe, specify <code>-e proto</code> flag to enable protobuf encoding.</li> </ol> </div> <h4 id=arista>Arista<a class=headerlink href=#arista title="Permanent link">#</a></h4> <p>YANG repo: <a href=https://github.com/aristanetworks/yang>aristanetworks/yang</a></p> <p>Arista uses a subset of OpenConfig modules and does not provide IETF modules inside their repo. So make sure you have IETF models available so you can reference it, a <code>openconfig/public</code> is a good candidate.</p> <p>Clone the Arista YANG repo:</p> <div class=highlight><pre><span></span><code>git clone https://github.com/aristanetworks/yang
cd yang
</code></pre></div> <p>Generate path suggestions for all Arista OpenConfig modules:</p> <div class=highlight><pre><span></span><code>gnmic --file EOS-4.23.2F/openconfig/public/release/models \
      --dir ~/public/third_party/ietf \
      --exclude ietf-interfaces \
      prompt
</code></pre></div> <h2 id=enumeration-suggestions>Enumeration suggestions<a class=headerlink href=#enumeration-suggestions title="Permanent link">#</a></h2> <p><code>gnmic</code> flags that can take pre-defined values (enumerations) will get suggestions as well. For example, no need to keep in mind which subscription modes are available, the prompt will hint you:</p> <p><img alt="enum suggestion" src=https://gitlab.com/rdodin/pics/-/wikis/uploads/a2772c709d869d5efc299db451e3d4a9/image.png></p> <h2 id=file-path-completions>File-path completions<a class=headerlink href=#file-path-completions title="Permanent link">#</a></h2> <p>Whenever a user needs to provide a file path in a prompt mode, the filepath suggestions will make the process interactive:</p> <script id=asciicast-uJyTI4nnQ52lSpIw5Ec7INLe7 src=https://asciinema.org/a/uJyTI4nnQ52lSpIw5Ec7INLe7.js async></script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../subscriptions/ class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Multiple subscriptions </div> </div> </a> <a href=../multi_outputs/output_intro/ class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Introduction </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/karimra target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.6a3d08fc.min.js></script> <script src=../../assets/javascripts/bundle.71201edf.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>